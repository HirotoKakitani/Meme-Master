hiro_accountInit(hiro_accountConfig);firebase.auth().onAuthStateChanged(function(user){if(user){console.log("logged in");console.log(user);document.getElementById("hiro_emailLink").innerHTML=user.email}
else{console.log("nobody logged in");window.location="index.html"}});window.onload=function(){var canvas=document.getElementById("hiro_Canvas");var upImg=new Image();var context=canvas.getContext("2d");var topVal="";var bottomVal="";context.font="700 20px Impact";context.strokeStyle="black";context.fillStyle='white';context.textAlign="center";function writeTop(){context.strokeText(topVal.toUpperCase(),canvas.width/2,20);context.fillText(topVal.toUpperCase(),canvas.width/2,20)};function writeBottom(){context.strokeText(bottomVal.toUpperCase(),canvas.width/2,canvas.height-20);context.fillText(bottomVal.toUpperCase(),canvas.width/2,canvas.height-20)};setTimeout(fillEditor,500);document.getElementById("hiro_picUpload").addEventListener("change",function(e){var file=new FileReader();file.onload=function(event){upImg.addEventListener("load",function(){context.drawImage(upImg,0,0,canvas.width,canvas.height)});upImg.src=event.target.result};file.readAsDataURL(e.target.files[0])},!1);document.getElementById("hiro_topText").onkeyup=function(){topVal=this.value;console.log(topVal)};document.getElementById("hiro_topText").addEventListener("focusout",function(){console.log(topVal)
context.clearRect(0,0,canvas.width,canvas.height)
context.drawImage(upImg,0,0,canvas.width,canvas.height);writeTop();writeBottom()});document.getElementById("hiro_bottomText").onkeyup=function(){bottomVal=this.value;console.log(bottomVal)};document.getElementById("hiro_bottomText").addEventListener("focusout",function(){console.log(bottomVal)
context.clearRect(0,0,canvas.width,canvas.height)
context.drawImage(upImg,0,0,canvas.width,canvas.height);writeTop(context,topVal);writeBottom(context,bottomVal)});document.getElementById("hiro_logOut").addEventListener("click",function(){firebase.auth().signOut().then(function(){console.log("signout success")}).catch(function(error){console.log(`${error.code}: ${error.message}`)})});document.getElementById("hiro_deleteMeme").addEventListener("click",function(){var delUserId=firebase.auth().currentUser.uid;var delName=document.getElementById("hiro_title").value;hiro_deleteMeme(delUserId,delName,function(){window.location="main.html"})});document.getElementById("hiro_saveMeme").addEventListener("click",function(){var userId=firebase.auth().currentUser.uid;var memeName=document.getElementById("hiro_title").value;var topText=document.getElementById("hiro_topText").value;var botText=document.getElementById("hiro_bottomText").value;var memeFlat=JSON.stringify(canvas.toDataURL());var memeRaw=upImg.src;hiro_saveImage(userId,memeFlat,memeName,topText,botText,memeRaw)});function fillEditor(){var prev=sessionStorage.getItem("linkFrom");var dataRef=firebase.database().ref("users/"+firebase.auth().currentUser.uid+"/"+prev);if(prev){dataRef.once("value").then(function(snapshot){var fillTop=snapshot.child("top_text").val();var fillBot=snapshot.child("bot_text").val();upImg=new Image();upImg.src=snapshot.child("raw_img").val();upImg.onload=function(){context.drawImage(upImg,0,0,canvas.width,canvas.height);topVal=fillTop;bottomVal=fillBot;writeTop();writeBottom()};document.getElementById("hiro_title").value=snapshot.child("meme_name").val();document.getElementById("hiro_topText").value=fillTop;document.getElementById("hiro_bottomText").value=fillBot});sessionStorage.clear()}
else{console.log("new meme")}}}